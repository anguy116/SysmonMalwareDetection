from pyspark.sql.types import *

schema = (StructType(
            [StructField("@timestamp", StringType(), True),
             StructField("winlog", StructType([
                 StructField("event_id", StringType(), True),
                 StructField("event_data", StructType(
                     [
                         StructField("CreationUtcTime", StringType(), True),
                         StructField("PreviousCreationUtcTime", StringType(), True)
                     ]
                 ), True),
             ]), True),
             StructField("process", StructType(
                 [
                     StructField("hash", StructType(
                         [
                             StructField("sha256",StringType(),True),
                             StructField("md5",StringType(),True)
                         ]
                     ),True),
                     StructField("name", StringType(), True),
                     StructField("parent", StructType(
                         [
                             StructField("pid", StringType(), True),
                             StructField("executable", StringType(), True)
                         ]
                     ))
                 ]
             ), True),
             StructField("host", StructType(
                 [
                     StructField("name", StringType(), True),
                     StructField("hostname", StringType(), True),
                     StructField("architecture", StringType(), True),
                     StructField("ip", ArrayType(StringType()), True),
                     StructField("mac", ArrayType(StringType()), True),
                     StructField("os", StructType(
                         [
                             StructField("build", StringType(), True),
                             StructField("name", StringType(), True),
                             StructField("version", StringType(), True)
                         ]
                     ), True),
                 ]
             ), True),
             StructField("event", StructType(
                 [
                     StructField("action", StringType(), True)
                 ]
             ), True),
             StructField("message", StringType(), True)]))